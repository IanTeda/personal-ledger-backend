{
  "name": "Personal Ledger Backend",
  "image": "mcr.microsoft.com/devcontainers/rust:1-bullseye",
  "features": {
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers/features/git:1": {},
    "ghcr.io/devcontainers/features/docker-in-docker:2": {},
    "ghcr.io/devcontainers/features/node:1": {
      "version": "22.20.0",
      "nodeGypDependencies": true,
      "installYarnUsingApt": true
    },
    "ghcr.io/itsmechlark/features/postgresql:1": {
      "version": "18"
    },
    "ghcr.io/warrenbuckley/codespace-features/sqlite:1": {},
    "ghcr.io/devcontainers-extra/features/grpcurl-asdf:2": {},
    "ghcr.io/eitsupi/devcontainer-features/mdbook:1": {},
    "ghcr.io/rocker-org/devcontainer-features/apt-packages:1": {
      "packages": "protobuf-compiler, libprotobuf-dev, libssl-dev, pkg-config, build-essential"
    }
  },
  "mounts": [
    "source=${localEnv:HOME}/.gitconfig,target=/home/vscode/.gitconfig,type=bind,consistency=cached",
    "source=${localEnv:HOME}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
  ],
  "postCreateCommand": "rustup component add clippy rustfmt; cargo install cargo-make cargo-watch cargo-audit sqlx-cli; npm install -g sqlite3@5.1.7",
  "containerEnv": {
    "RUST_BACKTRACE": "1",
    "CARGO_TERM_COLOR": "always"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "fill-labs.dependi",
        "github.copilot",
        "gruntfuggly.todo-tree",
        "mhutchie.git-graph",
        "ms-azuretools.vscode-docker",
        "ms-vscode.vscode-markdownlint",
        "mtxr.sqltools-driver-pg",
        "mtxr.sqltools-driver-sqlite",
        "mtxr.sqltools",
        "qwtel.sqlite-viewer",
        "redhat.vscode-yaml",
        "rust-lang.rust-analyzer",
        "tamasfe.even-better-toml",
        "usernamehw.errorlens",
        "vadimcn.vscode-lldb",
        "vector-of-bool.gitflow",
        "zxh404.vscode-proto3"
      ],
      "settings": {
        "sqltools.useConnectionStorage": "workspace",
        "sqltools.useNodeRuntime": true,
        "sqltools.connections": [
          {
            "name": "SQLite",
            "driver": "SQLite",
            "database": "./.personal-ledger-dev.db",
            "connectionTimeout": 15
          },
          {
            "ssh": "Disabled",
            "previewLimit": 50,
            "name": "PostgreSQL",
            "server": "127.0.0.1",
            "driver": "PostgreSQL",
            "connectString": "postgres://postgres@localhost:5432/personal-ledger-dev"
          }
        ],
        "sqlite.sqlite3": "/usr/bin/sqlite3"
      }
    }
  },
  "forwardPorts": [
    50065
  ],
  "portsAttributes": {
    "8001": {
      "label": "mdBook Server"
    },
    "50065": {
      "label": "Backend Server"
    }
  },
  "remoteUser": "vscode"
}